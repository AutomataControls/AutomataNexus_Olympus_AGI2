<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MEPT System - Memory-Enhanced Progressive Training | OLYMPUS AGI2</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #e0e0e0;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Navigation */
        .nav {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid #00cccc;
        }

        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav h1 {
            font-size: 24px;
            font-weight: 600;
            color: #00cccc;
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            color: #e0e0e0;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #00cccc;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%);
            padding: 100px 40px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 204, 204, 0.3);
        }

        .hero h1 {
            font-size: 56px;
            font-weight: 800;
            background: linear-gradient(135deg, #00cccc 0%, #00ffff 50%, #00cccc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            animation: glow 3s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 20px rgba(0, 204, 204, 0.5)); }
            to { filter: drop-shadow(0 0 30px rgba(0, 255, 255, 0.8)); }
        }

        .hero .subtitle {
            font-size: 24px;
            color: #999;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 40px;
        }

        /* Sections */
        .section {
            margin-bottom: 100px;
        }

        h2 {
            font-size: 42px;
            font-weight: 700;
            color: #00cccc;
            margin-bottom: 40px;
            text-align: center;
            position: relative;
            padding-bottom: 20px;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #00cccc, transparent);
        }

        h3 {
            font-size: 28px;
            font-weight: 600;
            color: #00cccc;
            margin: 40px 0 20px;
        }

        p {
            font-size: 18px;
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.8;
        }

        /* Feature Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .feature-card {
            background: rgba(0, 204, 204, 0.05);
            border: 2px solid rgba(0, 204, 204, 0.3);
            border-radius: 20px;
            padding: 40px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 204, 204, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-color: #00cccc;
            box-shadow: 0 10px 40px rgba(0, 204, 204, 0.3);
        }

        .feature-card:hover::before {
            opacity: 1;
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 20px;
            display: block;
        }

        .feature-card h4 {
            font-size: 24px;
            color: #00cccc;
            margin-bottom: 15px;
        }

        /* Architecture Diagram */
        .architecture-section {
            background: rgba(0, 204, 204, 0.02);
            border-radius: 30px;
            padding: 60px;
            margin: 60px 0;
            border: 1px solid rgba(0, 204, 204, 0.2);
        }

        .mermaid {
            display: flex;
            justify-content: center;
            margin: 40px 0;
        }

        /* Code Block */
        .code-block {
            background: #000;
            border: 1px solid #00cccc;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            overflow-x: auto;
            position: relative;
        }

        .code-block::before {
            content: 'Python';
            position: absolute;
            top: 10px;
            right: 10px;
            color: #00cccc;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .code-block code {
            color: #00cccc;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        /* Flow Diagram */
        .flow-section {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            text-align: center;
        }

        /* Specifications */
        .specs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .spec-item {
            background: rgba(0, 204, 204, 0.05);
            border: 1px solid rgba(0, 204, 204, 0.2);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
        }

        .spec-value {
            font-size: 32px;
            font-weight: 700;
            color: #00cccc;
            margin-bottom: 10px;
        }

        .spec-label {
            font-size: 14px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Training Info */
        .training-card {
            background: linear-gradient(135deg, rgba(0, 204, 204, 0.1) 0%, rgba(0, 204, 204, 0.05) 100%);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            border: 1px solid rgba(0, 204, 204, 0.3);
        }

        .training-card h3 {
            color: #00ffff;
            margin-bottom: 25px;
        }

        .training-list {
            list-style: none;
        }

        .training-list li {
            padding: 15px 0;
            border-bottom: 1px solid rgba(0, 204, 204, 0.2);
            position: relative;
            padding-left: 30px;
        }

        .training-list li::before {
            content: '▸';
            position: absolute;
            left: 0;
            color: #00cccc;
            font-size: 20px;
        }

        .training-list li:last-child {
            border-bottom: none;
        }

        /* Weight Visualization */
        .weight-vis {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .weight-item {
            text-align: center;
            padding: 20px;
            background: rgba(0, 204, 204, 0.1);
            border-radius: 15px;
            position: relative;
        }

        .weight-bar {
            width: 100%;
            height: 100px;
            background: #111;
            border-radius: 10px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }

        .weight-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to top, #00cccc, #00ffff);
            transition: height 0.3s ease;
        }

        .weight-label {
            font-size: 14px;
            color: #999;
        }

        .weight-value {
            font-size: 18px;
            font-weight: bold;
            color: #00cccc;
            margin-top: 10px;
        }

        /* Performance Metrics */
        .performance-section {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 30px;
            padding: 60px;
            margin: 60px 0;
            text-align: center;
        }

        .metric-row {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .metric {
            text-align: center;
        }

        .metric-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 3px solid #00cccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: 700;
            color: #00ffff;
            position: relative;
            background: radial-gradient(circle at center, rgba(0, 204, 204, 0.1), transparent);
            margin: 0 auto 20px;
        }

        .metric-label {
            font-size: 16px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 60px 40px;
            border-top: 1px solid rgba(0, 204, 204, 0.3);
            color: #666;
        }

        .footer a {
            color: #00cccc;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 36px;
            }
            
            .hero .subtitle {
                font-size: 18px;
            }
            
            h2 {
                font-size: 32px;
            }
            
            .nav-content {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .weight-vis {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-content">
            <h1>MEPT System</h1>
            <div class="nav-links">
                <a href="olympus_agi2.html">OLYMPUS AGI2</a>
                <a href="#architecture">Architecture</a>
                <a href="#components">Components</a>
                <a href="#loss">Loss Function</a>
                <a href="#performance">Performance</a>
            </div>
        </div>
    </nav>

    <div class="hero">
        <h1>MEPT</h1>
        <p class="subtitle">Memory-Enhanced Progressive Training - Preventing Catastrophic Forgetting</p>
    </div>

    <div class="container">
        <section class="section">
            <h2>Overview</h2>
            <p>MEPT (Memory-Enhanced Progressive Training) is an advanced training system designed to address catastrophic forgetting in the OLYMPUS AGI2 models. By maintaining experience replay buffers and pattern banks, MEPT ensures that models retain knowledge of successful exact matches while continuing to learn new patterns.</p>
            
            <div class="specs-grid">
                <div class="spec-item">
                    <div class="spec-value">100K</div>
                    <div class="spec-label">Buffer Capacity</div>
                </div>
                <div class="spec-item">
                    <div class="spec-value">20K</div>
                    <div class="spec-label">Pattern Bank Size</div>
                </div>
                <div class="spec-item">
                    <div class="spec-value">5</div>
                    <div class="spec-label">Loss Components</div>
                </div>
                <div class="spec-item">
                    <div class="spec-value">Dynamic</div>
                    <div class="spec-label">Weight Adjustment</div>
                </div>
            </div>
        </section>

        <section id="architecture" class="section">
            <h2>Architecture</h2>
            <div class="architecture-section">
                <div class="mermaid">
                    graph TD
                        A[Training Data] --> B[MEPT System]
                        B --> C[Experience Replay Buffer]
                        B --> D[Pattern Bank]
                        
                        C --> E[Priority Queue]
                        E --> F[Exact Matches]
                        E --> G[Regular Samples]
                        
                        D --> H[Pattern Hash Map]
                        D --> I[Transformation Rules]
                        
                        A --> J[MEPTAugmentedDataset]
                        C --> J
                        J --> K[Mixed Training Batch]
                        
                        K --> L[Neural Network]
                        L --> M[Predictions]
                        
                        M --> N[MEPTLoss]
                        N --> O[Reconstruction Loss]
                        N --> P[Exact Match Bonus]
                        N --> Q[Diversity Loss]
                        N --> R[Memory Alignment]
                        N --> S[Transformation Penalty]
                        
                        M --> T[Performance Monitor]
                        T --> U[Dynamic Weight Adjustment]
                        U --> N
                        
                        M --> C
                        M --> D
                        
                        style A fill:#00cccc,stroke:#fff
                        style M fill:#00ffff,stroke:#fff
                        style N fill:#009999,stroke:#fff
                </div>
            </div>

            <h3>System Flow</h3>
            <div class="flow-section">
                <p>MEPT integrates seamlessly into the training pipeline:</p>
                <ol style="text-align: left; max-width: 800px; margin: 20px auto;">
                    <li>Training samples are processed normally through the model</li>
                    <li>Successful exact matches are stored in the Experience Replay Buffer</li>
                    <li>Unique transformation patterns are added to the Pattern Bank</li>
                    <li>Future batches mix new data with replayed experiences (30% early, 20% later)</li>
                    <li>Dynamic loss weighting adapts based on performance history</li>
                </ol>
            </div>
        </section>

        <section id="components" class="section">
            <h2>Key Components</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <span class="feature-icon">💾</span>
                    <h4>Experience Replay Buffer</h4>
                    <p>Stores successful transformations with priority for exact matches. Maintains 50K exact matches and 50K regular samples with timestamp-based eviction.</p>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">🗂️</span>
                    <h4>Pattern Bank</h4>
                    <p>Hash-based storage of unique input-output patterns. Analyzes transformation types (rotate, flip, resize, etc.) and enables quick pattern lookup.</p>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">🎯</span>
                    <h4>Focal Loss</h4>
                    <p>Focuses training on hard examples using (1-p)² weighting. Prevents easy examples from dominating gradients while maintaining stable training.</p>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">⚖️</span>
                    <h4>Dynamic Weighting</h4>
                    <p>Adjusts loss component weights based on recent performance. Increases exact match weight when accuracy drops, balances when improving.</p>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">🔄</span>
                    <h4>Augmented Dataset</h4>
                    <p>Mixes regular training data with replay samples. Configurable replay ratio ensures continuous reinforcement of learned patterns.</p>
                </div>
                
                <div class="feature-card">
                    <span class="feature-icon">📊</span>
                    <h4>Memory Alignment Loss</h4>
                    <p>Encourages consistency with previously learned patterns using KL divergence between current predictions and stored outputs.</p>
                </div>
            </div>

            <div class="code-block">
                <code>
# MEPT Initialization<br>
replay_buffer = ExperienceReplayBuffer(capacity=100000)<br>
pattern_bank = PatternBank(max_patterns=20000)<br>
loss_fn = MEPTLoss(replay_buffer, pattern_bank, use_mept=True)<br>
<br>
# During training<br>
for batch in train_loader:<br>
    # Forward pass<br>
    predictions = model(inputs)<br>
    losses = loss_fn(predictions, targets, inputs)<br>
    <br>
    # Experiences automatically added to buffer<br>
    # Exact matches stored in pattern bank<br>
    # Dynamic weights adjusted based on performance<br>
<br>
# Create augmented dataset with replay<br>
augmented_dataset = MEPTAugmentedDataset(<br>
    base_dataset,<br>
    replay_buffer,<br>
    replay_ratio=0.3  # 30% replay samples<br>
)
                </code>
            </div>
        </section>

        <section id="loss" class="section">
            <h2>Loss Function Components</h2>
            
            <div class="training-card">
                <h3>MEPTLoss Calculation</h3>
                <p>The total loss combines multiple components with dynamic weighting:</p>
            </div>

            <div class="weight-vis">
                <div class="weight-item">
                    <div class="weight-label">Reconstruction</div>
                    <div class="weight-bar">
                        <div class="weight-fill" style="height: 50%;"></div>
                    </div>
                    <div class="weight-value">1.0</div>
                </div>
                
                <div class="weight-item">
                    <div class="weight-label">Exact Match</div>
                    <div class="weight-bar">
                        <div class="weight-fill" style="height: 100%;"></div>
                    </div>
                    <div class="weight-value">5.0</div>
                </div>
                
                <div class="weight-item">
                    <div class="weight-label">Diversity</div>
                    <div class="weight-bar">
                        <div class="weight-fill" style="height: 15%;"></div>
                    </div>
                    <div class="weight-value">0.3</div>
                </div>
                
                <div class="weight-item">
                    <div class="weight-label">Memory</div>
                    <div class="weight-bar">
                        <div class="weight-fill" style="height: 20%;"></div>
                    </div>
                    <div class="weight-value">0.4</div>
                </div>
                
                <div class="weight-item">
                    <div class="weight-label">Transform</div>
                    <div class="weight-bar">
                        <div class="weight-fill" style="height: 60%;"></div>
                    </div>
                    <div class="weight-value">2.0*</div>
                </div>
            </div>

            <div class="training-card">
                <h3>Loss Components</h3>
                <ul class="training-list">
                    <li><strong>Focal Reconstruction Loss:</strong> CE loss with (1-p)² weighting for hard example mining</li>
                    <li><strong>Exact Match Bonus:</strong> -5.0 reward for perfect grid predictions</li>
                    <li><strong>Diversity Loss:</strong> Encourages prediction entropy to prevent mode collapse</li>
                    <li><strong>Memory Alignment:</strong> KL divergence with stored successful patterns</li>
                    <li><strong>Transformation Penalty:</strong> 2.0× penalty for copying input when transformation expected</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>Pattern Analysis</h2>
            
            <div class="training-card">
                <h3>Transformation Types</h3>
                <p>MEPT automatically categorizes transformations for better pattern understanding:</p>
                <ul class="training-list">
                    <li><strong>Identity:</strong> Output matches input exactly</li>
                    <li><strong>Rotate_90:</strong> 90-degree rotation detected</li>
                    <li><strong>Flip_vertical/horizontal:</strong> Mirror transformations</li>
                    <li><strong>Color_reduction:</strong> Fewer unique colors in output</li>
                    <li><strong>Pattern_extraction:</strong> Subset of input pixels retained</li>
                    <li><strong>Resize:</strong> Dimension changes detected</li>
                    <li><strong>Complex:</strong> Other transformation types</li>
                </ul>
            </div>

            <div class="code-block">
                <code>
# Pattern Bank Usage<br>
# Add successful pattern<br>
pattern_bank.add_pattern(input_grid, output_grid)<br>
<br>
# Quick lookup for known patterns<br>
stored_output = pattern_bank.lookup_pattern(input_grid)<br>
if stored_output is not None:<br>
    # Use stored transformation<br>
    return stored_output<br>
<br>
# Get similar transformations<br>
similar = pattern_bank.get_similar_transformations(<br>
    input_grid, output_grid, k=5<br>
)<br>
# Returns up to 5 examples of the same transformation type
                </code>
            </div>
        </section>

        <section id="performance" class="section">
            <h2>Performance Impact</h2>
            
            <div class="performance-section">
                <div class="metric-row">
                    <div class="metric">
                        <div class="metric-circle">93.2%</div>
                        <div class="metric-label">Peak Exact Match</div>
                    </div>
                    <div class="metric">
                        <div class="metric-circle">→21.8%</div>
                        <div class="metric-label">Without MEPT</div>
                    </div>
                    <div class="metric">
                        <div class="metric-circle">→40-70%</div>
                        <div class="metric-label">With MEPT (Target)</div>
                    </div>
                </div>
                
                <h3>Key Benefits</h3>
                <ul style="max-width: 800px; margin: 40px auto; text-align: left;">
                    <li>Prevents catastrophic forgetting of exact match patterns</li>
                    <li>Maintains high performance across all curriculum stages</li>
                    <li>Dynamically adapts to training challenges</li>
                    <li>Efficient memory usage with priority-based storage</li>
                    <li>Quick pattern lookup reduces redundant learning</li>
                    <li>Focal loss improves hard example learning</li>
                </ul>
            </div>
        </section>

        <section class="section">
            <h2>Integration Guide</h2>
            
            <div class="training-card">
                <h3>Enabling MEPT</h3>
                <p>MEPT is enabled by default in the V4 trainer. Control it with:</p>
                <div class="code-block">
                    <code>
# Enable/Disable MEPT<br>
USE_MEPT = True  # Set to False to disable<br>
<br>
# MEPT will automatically:<br>
# - Initialize replay buffer and pattern bank<br>
# - Replace standard loss with MEPTLoss<br>
# - Apply dataset augmentation when buffer has samples<br>
# - Report MEPT statistics during validation<br>
# - Adjust weights based on performance
                    </code>
                </div>
            </div>

            <div class="training-card">
                <h3>Configuration Options</h3>
                <ul class="training-list">
                    <li><strong>Buffer Capacity:</strong> Default 100K (50K exact, 50K regular)</li>
                    <li><strong>Pattern Bank Size:</strong> Default 20K unique patterns</li>
                    <li><strong>Replay Ratio:</strong> 0.3 for Stage 0, 0.2 for later stages</li>
                    <li><strong>Exact Match Ratio:</strong> 0.7 in replay sampling</li>
                    <li><strong>Performance History:</strong> Last 100 samples for weight adjustment</li>
                </ul>
            </div>
        </section>
    </div>

    <div class="footer">
        <p>MEPT System - Part of <a href="olympus_agi2.html">OLYMPUS AGI2</a> Training Infrastructure</p>
        <p>&copy; 2024 AutomataNexus LLC. All rights reserved.</p>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#00cccc',
                primaryTextColor: '#e0e0e0',
                primaryBorderColor: '#00cccc',
                lineColor: '#00cccc',
                secondaryColor: '#009999',
                tertiaryColor: '#006666',
                background: '#1a1a1a',
                mainBkg: '#0a0a0a',
                secondBkg: '#1a1a1a'
            }
        });
    </script>
</body>
</html>